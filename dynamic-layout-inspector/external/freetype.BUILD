config_setting(
    name = "windows",
    values = {"host_cpu": "x64_windows"},
    visibility = ["//visibility:public"],
)

srcs = glob(["src/**/*.h"]) + [
    "src/autofit/autofit.c",
    "src/base/ftbase.c",
    "src/base/ftbbox.c",
    "src/base/ftbitmap.c",
    "src/base/ftdebug.c",
    "src/base/ftfstype.c",
    "src/base/ftgasp.c",
    "src/base/ftglyph.c",
    "src/base/ftinit.c",
    "src/base/ftmm.c",
    "src/base/ftstroke.c",
    "src/base/ftsystem.c",
    "src/base/fttype1.c",
    "src/cff/cff.c",
    "src/cid/type1cid.c",
    "src/gzip/ftgzip.c",
    "src/psaux/psaux.c",
    "src/pshinter/pshinter.c",
    "src/psnames/psnames.c",
    "src/raster/raster.c",
    "src/sdf/ftbsdf.c",
    "src/sdf/ftsdf.c",
    "src/sdf/ftsdfcommon.c",
    "src/sdf/ftsdfrend.c",
    "src/sfnt/sfnt.c",
    "src/smooth/smooth.c",
    "src/svg/ftsvg.c",
    "src/truetype/truetype.c",
    "src/type1/type1.c",
]

cc_library(
    name = "freetype",
    srcs = srcs,
    hdrs = glob(["include/**/*.h"]),
    copts = [
        "-W",
        "-Wall",
        "-Wno-implicit-fallthrough",
        "-DDARWIN_NO_CARBON",
        "-DFT2_BUILD_LIBRARY",
        "-O2",
        "-Wno-unused-parameter",
        "-Wno-unused-variable",
    ],
    includes = [
        "include",
    ],
    textual_hdrs = glob(
        ["src/**/*.c"],
        exclude = srcs,
    ),
    visibility = ["//visibility:public"],
    deps = [
        "@libpng_repo//:libpng",
        "@zlib_repo//:zlib",
    ],
)
